(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{5633:function(e,t,i){Promise.resolve().then(i.bind(i,3084))},3084:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return o}});var n=i(7437),a=i(2265),s=i(8472),r=i(4550);function c(){{let e=window.location.protocol,t=window.location.hostname,i=window.location.port?":".concat(window.location.port):"";return"".concat(e,"//").concat(t).concat(i)}}function o(){let[e,t]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[l,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{u()},[]);let u=async()=>{g(!0);try{let e=await s.Z.get("".concat(c(),"/api/v1/webauthn/registration/status"));t(e.data.registered?"registered":"not_registered")}catch(e){o("Unable to check registration status. Please try again later.")}finally{g(!1)}},d=async()=>{g(!0),t("registering"),o("");try{let e=(await s.Z.post("".concat(c(),"/api/v1/webauthn/registration/begin"))).data,i=await (0,r.RQ)(e);(await s.Z.post("".concat(c(),"/api/v1/webauthn/registration/finish"),i)).data.success?(t("registered"),alert("Registration successful!")):(t("not_registered"),o("Registration failed."))}catch(e){t("not_registered"),o("Error during registration: ".concat(e.message))}finally{g(!1)}},h=async()=>{g(!0),t("authenticating"),o("");try{let e=(await s.Z.post("".concat(c(),"/api/v1/webauthn/login/begin"))).data,i=await (0,r.oz)(e);(await s.Z.post("".concat(c(),"/api/v1/webauthn/login/finish"),i)).data.success?alert("Login successful!"):(o("Login failed."),t("registered"))}catch(e){t("registered"),o("Error during login: ".concat(e.message))}finally{g(!1)}};return(0,n.jsxs)("div",{className:"webauthn-ui",children:[l&&(0,n.jsx)("p",{children:"Loading..."}),!l&&(0,n.jsxs)(n.Fragment,{children:["not_registered"===e&&(0,n.jsxs)("div",{className:"not-registered",children:[(0,n.jsx)("h2",{children:"Register Your Device"}),(0,n.jsx)("p",{children:"Secure your account with a passkey or security key."}),i&&(0,n.jsx)("p",{className:"error-message",children:i}),(0,n.jsx)("button",{onClick:d,disabled:l,children:l?"Registering...":"Register"})]}),"registered"===e&&(0,n.jsxs)("div",{className:"registered",children:[(0,n.jsx)("h2",{children:"Welcome Back!"}),(0,n.jsx)("p",{children:"Use your passkey to log in securely."}),i&&(0,n.jsx)("p",{className:"error-message",children:i}),(0,n.jsx)("button",{onClick:h,disabled:l,children:l?"Authenticating...":"Log In"})]}),"registering"===e&&(0,n.jsx)("p",{children:"Registering... Please follow the instructions."}),"authenticating"===e&&(0,n.jsx)("p",{children:"Authenticating... Please follow the instructions."})]})]})}}},function(e){e.O(0,[48,971,23,744],function(){return e(e.s=5633)}),_N_E=e.O()}]);